import time
from RPLCD.i2c import CharLCD

# Initialize the LCD (Update address if necessary)
lcd = CharLCD(i2c_expander='PCF8574', address=0x27, port=1, cols=16, rows=2, charmap='A00', auto_linebreaks=False)

# Define horse animation frames
horse_chars = [
    [
        [0x00, 0x00, 0x00, 0x00, 0x03, 0x07, 0x0E, 0x0E],
        [0x00, 0x00, 0x00, 0x00, 0x0F, 0x1F, 0x1F, 0x1F],
        [0x00, 0x00, 0x00, 0x03, 0x07, 0x1F, 0x1F, 0x1F],
        [0x00, 0x00, 0x05, 0x1F, 0x1D, 0x1F, 0x16, 0x06],
        [0x0C, 0x18, 0x10, 0x00, 0x01, 0x01, 0x01, 0x00],
        [0x1F, 0x1F, 0x1E, 0x17, 0x00, 0x00, 0x10, 0x00],
        [0x1F, 0x1F, 0x03, 0x02, 0x14, 0x04, 0x02, 0x00],
        [0x1C, 0x1C, 0x04, 0x04, 0x08, 0x00, 0x00, 0x00]
    ],
    [
        [0x00, 0x00, 0x00, 0x07, 0x0F, 0x0E, 0x1C, 0x18],
        [0x00, 0x00, 0x00, 0x0F, 0x1F, 0x1F, 0x1F, 0x1F],
        [0x00, 0x00, 0x01, 0x03, 0x1F, 0x1F, 0x1F, 0x1F],
        [0x14, 0x1C, 0x1A, 0x1E, 0x1F, 0x13, 0x10, 0x10],
        [0x13, 0x13, 0x02, 0x02, 0x04, 0x00, 0x00, 0x00],
        [0x1F, 0x07, 0x0E, 0x06, 0x01, 0x00, 0x00, 0x00],
        [0x0F, 0x03, 0x03, 0x01, 0x01, 0x00, 0x00, 0x00],
        [0x10, 0x18, 0x0C, 0x02, 0x02, 0x11, 0x00, 0x00]
    ]
]

def display_intro():
    """Displays an introduction message before the animation starts."""
    lcd.clear()
    lcd.cursor_pos = (0, 4)
    lcd.write_string("Subscribe")
    lcd.cursor_pos = (1, 0)
    lcd.write_string("TeachMeSomething")
    time.sleep(3)
    lcd.clear()

def horse_animation():
    """Animates the horse moving across the LCD screen."""
    x = 0  # Start position

    # while True:
    for i in range(10):
        for f in range(2):  # Alternate frames for animation effect
            lcd.clear()
            
            # Load the current frame's custom characters
            for i in range(8):
                lcd.create_char(i, horse_chars[f][i])

            # Draw horse at position x
            for c in range(4):
                xc = x + c
                if 0 <= xc < 16:  # Keep it within LCD bounds
                    lcd.cursor_pos = (0, xc)
                    lcd.write_string(chr(c))  # Display the created custom char
                    lcd.cursor_pos = (1, xc)
                    lcd.write_string(chr(c+4))  # Display the lower part
            
            time.sleep(0.01)  # Animation speed
            x += 1  # Move right

